(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39584,e=>{"use strict";var r=e.i(43476),t=e.i(71645),s=e.i(57951),a=e.i(19455),l=e.i(15288),o=e.i(99676),n=e.i(87486),i=e.i(24687),c=e.i(93479),d=e.i(39312),u=e.i(94351),m=e.i(90597),h=e.i(94983),p=e.i(61911),x=e.i(92270),f=e.i(31278),v=e.i(27612),g=e.i(18566),b=e.i(46696),w=e.i(41867),j=e.i(9637),N=e.i(55436);let y=(0,e.i(75254).default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var C=e.i(48425),_=e.i(96626),S=e.i(30030),E=e.i(20783),k=e.i(30207),R=e.i(86318),T=e.i(34620),P=e.i(70152),A=e.i(81140),L="ScrollArea",[D,z]=(0,S.createContextScope)(L),[B,H]=D(L),I=t.forwardRef((e,s)=>{let{__scopeScrollArea:a,type:l="hover",dir:o,scrollHideDelay:n=600,...i}=e,[c,d]=t.useState(null),[u,m]=t.useState(null),[h,p]=t.useState(null),[x,f]=t.useState(null),[v,g]=t.useState(null),[b,w]=t.useState(0),[j,N]=t.useState(0),[y,_]=t.useState(!1),[S,k]=t.useState(!1),T=(0,E.useComposedRefs)(s,e=>d(e)),P=(0,R.useDirection)(o);return(0,r.jsx)(B,{scope:a,type:l,dir:P,scrollHideDelay:n,scrollArea:c,viewport:u,onViewportChange:m,content:h,onContentChange:p,scrollbarX:x,onScrollbarXChange:f,scrollbarXEnabled:y,onScrollbarXEnabledChange:_,scrollbarY:v,onScrollbarYChange:g,scrollbarYEnabled:S,onScrollbarYEnabledChange:k,onCornerWidthChange:w,onCornerHeightChange:N,children:(0,r.jsx)(C.Primitive.div,{dir:P,...i,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":j+"px",...e.style}})})});I.displayName=L;var F="ScrollAreaViewport",W=t.forwardRef((e,s)=>{let{__scopeScrollArea:a,children:l,nonce:o,...n}=e,i=H(F,a),c=t.useRef(null),d=(0,E.useComposedRefs)(s,c,i.onViewportChange);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),(0,r.jsx)(C.Primitive.div,{"data-radix-scroll-area-viewport":"",...n,ref:d,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,r.jsx)("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:l})})]})});W.displayName=F;var U="ScrollAreaScrollbar",O=t.forwardRef((e,s)=>{let{forceMount:a,...l}=e,o=H(U,e.__scopeScrollArea),{onScrollbarXEnabledChange:n,onScrollbarYEnabledChange:i}=o,c="horizontal"===e.orientation;return t.useEffect(()=>(c?n(!0):i(!0),()=>{c?n(!1):i(!1)}),[c,n,i]),"hover"===o.type?(0,r.jsx)(q,{...l,ref:s,forceMount:a}):"scroll"===o.type?(0,r.jsx)($,{...l,ref:s,forceMount:a}):"auto"===o.type?(0,r.jsx)(M,{...l,ref:s,forceMount:a}):"always"===o.type?(0,r.jsx)(Y,{...l,ref:s}):null});O.displayName=U;var q=t.forwardRef((e,s)=>{let{forceMount:a,...l}=e,o=H(U,e.__scopeScrollArea),[n,i]=t.useState(!1);return t.useEffect(()=>{let e=o.scrollArea,r=0;if(e){let t=()=>{window.clearTimeout(r),i(!0)},s=()=>{r=window.setTimeout(()=>i(!1),o.scrollHideDelay)};return e.addEventListener("pointerenter",t),e.addEventListener("pointerleave",s),()=>{window.clearTimeout(r),e.removeEventListener("pointerenter",t),e.removeEventListener("pointerleave",s)}}},[o.scrollArea,o.scrollHideDelay]),(0,r.jsx)(_.Presence,{present:a||n,children:(0,r.jsx)(M,{"data-state":n?"visible":"hidden",...l,ref:s})})}),$=t.forwardRef((e,s)=>{var a;let{forceMount:l,...o}=e,n=H(U,e.__scopeScrollArea),i="horizontal"===e.orientation,c=ed(()=>u("SCROLL_END"),100),[d,u]=(a={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},t.useReducer((e,r)=>a[e][r]??e,"hidden"));return t.useEffect(()=>{if("idle"===d){let e=window.setTimeout(()=>u("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(e)}},[d,n.scrollHideDelay,u]),t.useEffect(()=>{let e=n.viewport,r=i?"scrollLeft":"scrollTop";if(e){let t=e[r],s=()=>{let s=e[r];t!==s&&(u("SCROLL"),c()),t=s};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)}},[n.viewport,i,u,c]),(0,r.jsx)(_.Presence,{present:l||"hidden"!==d,children:(0,r.jsx)(Y,{"data-state":"hidden"===d?"hidden":"visible",...o,ref:s,onPointerEnter:(0,A.composeEventHandlers)(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:(0,A.composeEventHandlers)(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),M=t.forwardRef((e,s)=>{let a=H(U,e.__scopeScrollArea),{forceMount:l,...o}=e,[n,i]=t.useState(!1),c="horizontal"===e.orientation,d=ed(()=>{if(a.viewport){let e=a.viewport.offsetWidth<a.viewport.scrollWidth,r=a.viewport.offsetHeight<a.viewport.scrollHeight;i(c?e:r)}},10);return eu(a.viewport,d),eu(a.content,d),(0,r.jsx)(_.Presence,{present:l||n,children:(0,r.jsx)(Y,{"data-state":n?"visible":"hidden",...o,ref:s})})}),Y=t.forwardRef((e,s)=>{let{orientation:a="vertical",...l}=e,o=H(U,e.__scopeScrollArea),n=t.useRef(null),i=t.useRef(0),[c,d]=t.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=el(c.viewport,c.content),m={...l,sizes:c,onSizesChange:d,hasThumb:!!(u>0&&u<1),onThumbChange:e=>n.current=e,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:e=>i.current=e};function h(e,r){return function(e,r,t,s="ltr"){let a=eo(t),l=r||a/2,o=t.scrollbar.paddingStart+l,n=t.scrollbar.size-t.scrollbar.paddingEnd-(a-l),i=t.content-t.viewport;return ei([o,n],"ltr"===s?[0,i]:[-1*i,0])(e)}(e,i.current,c,r)}return"horizontal"===a?(0,r.jsx)(X,{...m,ref:s,onThumbPositionChange:()=>{if(o.viewport&&n.current){let e=en(o.viewport.scrollLeft,c,o.dir);n.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{o.viewport&&(o.viewport.scrollLeft=e)},onDragScroll:e=>{o.viewport&&(o.viewport.scrollLeft=h(e,o.dir))}}):"vertical"===a?(0,r.jsx)(V,{...m,ref:s,onThumbPositionChange:()=>{if(o.viewport&&n.current){let e=en(o.viewport.scrollTop,c);n.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{o.viewport&&(o.viewport.scrollTop=e)},onDragScroll:e=>{o.viewport&&(o.viewport.scrollTop=h(e))}}):null}),X=t.forwardRef((e,s)=>{let{sizes:a,onSizesChange:l,...o}=e,n=H(U,e.__scopeScrollArea),[i,c]=t.useState(),d=t.useRef(null),u=(0,E.useComposedRefs)(s,d,n.onScrollbarXChange);return t.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),(0,r.jsx)(Z,{"data-orientation":"horizontal",...o,ref:u,sizes:a,style:{bottom:0,left:"rtl"===n.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===n.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":eo(a)+"px",...e.style},onThumbPointerDown:r=>e.onThumbPointerDown(r.x),onDragScroll:r=>e.onDragScroll(r.x),onWheelScroll:(r,t)=>{if(n.viewport){var s,a;let l=n.viewport.scrollLeft+r.deltaX;e.onWheelScroll(l),s=l,a=t,s>0&&s<a&&r.preventDefault()}},onResize:()=>{d.current&&n.viewport&&i&&l({content:n.viewport.scrollWidth,viewport:n.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:ea(i.paddingLeft),paddingEnd:ea(i.paddingRight)}})}})}),V=t.forwardRef((e,s)=>{let{sizes:a,onSizesChange:l,...o}=e,n=H(U,e.__scopeScrollArea),[i,c]=t.useState(),d=t.useRef(null),u=(0,E.useComposedRefs)(s,d,n.onScrollbarYChange);return t.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),(0,r.jsx)(Z,{"data-orientation":"vertical",...o,ref:u,sizes:a,style:{top:0,right:"ltr"===n.dir?0:void 0,left:"rtl"===n.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":eo(a)+"px",...e.style},onThumbPointerDown:r=>e.onThumbPointerDown(r.y),onDragScroll:r=>e.onDragScroll(r.y),onWheelScroll:(r,t)=>{if(n.viewport){var s,a;let l=n.viewport.scrollTop+r.deltaY;e.onWheelScroll(l),s=l,a=t,s>0&&s<a&&r.preventDefault()}},onResize:()=>{d.current&&n.viewport&&i&&l({content:n.viewport.scrollHeight,viewport:n.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:ea(i.paddingTop),paddingEnd:ea(i.paddingBottom)}})}})}),[K,G]=D(U),Z=t.forwardRef((e,s)=>{let{__scopeScrollArea:a,sizes:l,hasThumb:o,onThumbChange:n,onThumbPointerUp:i,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:m,onResize:h,...p}=e,x=H(U,a),[f,v]=t.useState(null),g=(0,E.useComposedRefs)(s,e=>v(e)),b=t.useRef(null),w=t.useRef(""),j=x.viewport,N=l.content-l.viewport,y=(0,k.useCallbackRef)(m),_=(0,k.useCallbackRef)(d),S=ed(h,10);function R(e){b.current&&u({x:e.clientX-b.current.left,y:e.clientY-b.current.top})}return t.useEffect(()=>{let e=e=>{let r=e.target;f?.contains(r)&&y(e,N)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[j,f,N,y]),t.useEffect(_,[l,_]),eu(f,S),eu(x.content,S),(0,r.jsx)(K,{scope:a,scrollbar:f,hasThumb:o,onThumbChange:(0,k.useCallbackRef)(n),onThumbPointerUp:(0,k.useCallbackRef)(i),onThumbPositionChange:_,onThumbPointerDown:(0,k.useCallbackRef)(c),children:(0,r.jsx)(C.Primitive.div,{...p,ref:g,style:{position:"absolute",...p.style},onPointerDown:(0,A.composeEventHandlers)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),b.current=f.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),R(e))}),onPointerMove:(0,A.composeEventHandlers)(e.onPointerMove,R),onPointerUp:(0,A.composeEventHandlers)(e.onPointerUp,e=>{let r=e.target;r.hasPointerCapture(e.pointerId)&&r.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=w.current,x.viewport&&(x.viewport.style.scrollBehavior=""),b.current=null})})})}),J="ScrollAreaThumb",Q=t.forwardRef((e,t)=>{let{forceMount:s,...a}=e,l=G(J,e.__scopeScrollArea);return(0,r.jsx)(_.Presence,{present:s||l.hasThumb,children:(0,r.jsx)(ee,{ref:t,...a})})}),ee=t.forwardRef((e,s)=>{let{__scopeScrollArea:a,style:l,...o}=e,n=H(J,a),i=G(J,a),{onThumbPositionChange:c}=i,d=(0,E.useComposedRefs)(s,e=>i.onThumbChange(e)),u=t.useRef(void 0),m=ed(()=>{u.current&&(u.current(),u.current=void 0)},100);return t.useEffect(()=>{let e=n.viewport;if(e){let r=()=>{m(),u.current||(u.current=ec(e,c),c())};return c(),e.addEventListener("scroll",r),()=>e.removeEventListener("scroll",r)}},[n.viewport,m,c]),(0,r.jsx)(C.Primitive.div,{"data-state":i.hasThumb?"visible":"hidden",...o,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...l},onPointerDownCapture:(0,A.composeEventHandlers)(e.onPointerDownCapture,e=>{let r=e.target.getBoundingClientRect(),t=e.clientX-r.left,s=e.clientY-r.top;i.onThumbPointerDown({x:t,y:s})}),onPointerUp:(0,A.composeEventHandlers)(e.onPointerUp,i.onThumbPointerUp)})});Q.displayName=J;var er="ScrollAreaCorner",et=t.forwardRef((e,t)=>{let s=H(er,e.__scopeScrollArea),a=!!(s.scrollbarX&&s.scrollbarY);return"scroll"!==s.type&&a?(0,r.jsx)(es,{...e,ref:t}):null});et.displayName=er;var es=t.forwardRef((e,s)=>{let{__scopeScrollArea:a,...l}=e,o=H(er,a),[n,i]=t.useState(0),[c,d]=t.useState(0),u=!!(n&&c);return eu(o.scrollbarX,()=>{let e=o.scrollbarX?.offsetHeight||0;o.onCornerHeightChange(e),d(e)}),eu(o.scrollbarY,()=>{let e=o.scrollbarY?.offsetWidth||0;o.onCornerWidthChange(e),i(e)}),u?(0,r.jsx)(C.Primitive.div,{...l,ref:s,style:{width:n,height:c,position:"absolute",right:"ltr"===o.dir?0:void 0,left:"rtl"===o.dir?0:void 0,bottom:0,...e.style}}):null});function ea(e){return e?parseInt(e,10):0}function el(e,r){let t=e/r;return isNaN(t)?0:t}function eo(e){let r=el(e.viewport,e.content),t=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-t)*r,18)}function en(e,r,t="ltr"){let s=eo(r),a=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,l=r.scrollbar.size-a,o=r.content-r.viewport,n=(0,P.clamp)(e,"ltr"===t?[0,o]:[-1*o,0]);return ei([0,o],[0,l-s])(n)}function ei(e,r){return t=>{if(e[0]===e[1]||r[0]===r[1])return r[0];let s=(r[1]-r[0])/(e[1]-e[0]);return r[0]+s*(t-e[0])}}var ec=(e,r=()=>{})=>{let t={left:e.scrollLeft,top:e.scrollTop},s=0;return!function a(){let l={left:e.scrollLeft,top:e.scrollTop},o=t.left!==l.left,n=t.top!==l.top;(o||n)&&r(),t=l,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function ed(e,r){let s=(0,k.useCallbackRef)(e),a=t.useRef(0);return t.useEffect(()=>()=>window.clearTimeout(a.current),[]),t.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(s,r)},[s,r])}function eu(e,r){let t=(0,k.useCallbackRef)(r);(0,T.useLayoutEffect)(()=>{let r=0;if(e){let s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,t])}var em=e.i(75157);let eh=t.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(I,{ref:a,className:(0,em.cn)("relative overflow-hidden",e),...s,children:[(0,r.jsx)(W,{className:"h-full w-full rounded-[inherit]",children:t}),(0,r.jsx)(ep,{}),(0,r.jsx)(et,{})]}));eh.displayName=I.displayName;let ep=t.forwardRef(({className:e,orientation:t="vertical",...s},a)=>(0,r.jsx)(O,{ref:a,orientation:t,className:(0,em.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...s,children:(0,r.jsx)(Q,{className:"relative flex-1 rounded-full bg-border"})}));ep.displayName=O.displayName;let ex=()=>{let e=(0,g.useRouter)(),[s,a]=(0,t.useState)(""),[l,n]=(0,t.useState)({users:[],posts:[]}),[i,d]=(0,t.useState)(!1),[u,m]=(0,t.useState)(!1),h=(0,t.useRef)(null),[p,x]=(0,t.useState)(s);(0,t.useEffect)(()=>{let e=setTimeout(()=>{x(s)},300);return()=>clearTimeout(e)},[s]),(0,t.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,t.useEffect)(()=>{p.trim().length>2?v():n({users:[],posts:[]})},[p]);let v=async()=>{d(!0),m(!0);try{let{data:e}=await w.supabase.from("profiles").select("id, full_name, avatar_url").ilike("full_name",`%${p}%`).limit(5),{data:r}=await w.supabase.from("posts").select("id, content, created_at, user:user_id(full_name)").ilike("content",`%${p}%`).limit(5);n({users:e||[],posts:r||[]})}catch(e){console.error("Search error:",e)}finally{d(!1)}};return(0,r.jsxs)("div",{className:"relative w-full max-w-md",ref:h,children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(N.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,r.jsx)(c.Input,{placeholder:"Search users or threads...",className:"pl-9 bg-muted/50 border-0 focus-visible:ring-1 focus-visible:ring-primary",value:s,onChange:e=>a(e.target.value),onFocus:()=>{(l.users.length>0||l.posts.length>0)&&m(!0)}}),i&&(0,r.jsx)(f.Loader2,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 animate-spin text-muted-foreground"})]}),u&&(l.users.length>0||l.posts.length>0)&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-card border border-border/40 rounded-lg shadow-lg z-50 overflow-hidden",children:(0,r.jsxs)(eh,{className:"max-h-[400px]",children:[l.users.length>0&&(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground px-2 py-1 mb-1",children:"People"}),l.users.map(t=>(0,r.jsxs)("div",{className:"flex items-center gap-3 p-2 hover:bg-muted/50 rounded-md cursor-pointer",onClick:()=>{var r;return r=t.id,void(e.push(`/profile/${r}`),m(!1),a(""))},children:[(0,r.jsxs)(o.Avatar,{className:"w-8 h-8",children:[(0,r.jsx)(o.AvatarImage,{src:t.avatar_url}),(0,r.jsx)(o.AvatarFallback,{children:t.full_name?.charAt(0)})]}),(0,r.jsx)("span",{className:"text-sm font-medium",children:t.full_name})]},t.id))]}),l.users.length>0&&l.posts.length>0&&(0,r.jsx)("div",{className:"h-px bg-border/40 mx-2"}),l.posts.length>0&&(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground px-2 py-1 mb-1",children:"Threads"}),l.posts.map(t=>(0,r.jsxs)("div",{className:"flex items-start gap-3 p-2 hover:bg-muted/50 rounded-md cursor-pointer",onClick:()=>(t.id,void(e.push("/community"),m(!1),a(""))),children:[(0,r.jsx)(y,{className:"w-4 h-4 mt-1 text-muted-foreground"}),(0,r.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,r.jsx)("p",{className:"text-sm truncate",children:t.content}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["by ",t.user?.full_name]})]})]},t.id))]})]})})]})};e.s(["default",0,()=>{let{user:e,signOut:N}=(0,s.useAuth)(),y=(0,g.useRouter)(),[C,_]=(0,t.useState)(""),[S,E]=(0,t.useState)([]),[k,R]=(0,t.useState)(!0),[T,P]=(0,t.useState)(!1);(0,t.useEffect)(()=>{A()},[e]);let A=async()=>{try{let{data:r,error:t}=await w.supabase.from("posts").select(`
                    *,
                    profiles:user_id (
                        full_name,
                        avatar_url
                    )
                `).order("created_at",{ascending:!1});if(t)throw t;if(e&&r){let t=await Promise.all(r.map(async r=>{let{count:t}=await w.supabase.from("likes").select("*",{count:"exact",head:!0}).eq("post_id",r.id).eq("user_id",e.id);return{...r,user_has_liked:!!t&&t>0}}));E(t)}else E(r)}catch(e){console.error("Error fetching posts:",e),b.toast.error("Failed to load posts")}finally{R(!1)}},L=async()=>{await N()},D=async()=>{if(!C.trim())return void b.toast.error("Please write something to post");if(e){P(!0);try{let{error:r}=await w.supabase.from("posts").insert({user_id:e.id,content:C});if(r)throw r;b.toast.success("Post created successfully!"),_(""),A()}catch(e){console.error("Error creating post:",e),b.toast.error("Failed to create post")}finally{P(!1)}}},z=async(r,t)=>{if(e){E(e=>e.map(e=>e.id===r?{...e,likes_count:t?e.likes_count-1:e.likes_count+1,user_has_liked:!t}:e));try{t?(await w.supabase.from("likes").delete().eq("post_id",r).eq("user_id",e.id),await w.supabase.from("posts").update({likes_count:S.find(e=>e.id===r).likes_count-1}).eq("id",r)):(await w.supabase.from("likes").insert({post_id:r,user_id:e.id}),await w.supabase.from("posts").update({likes_count:S.find(e=>e.id===r).likes_count+1}).eq("id",r))}catch(e){console.error("Error toggling like:",e),A()}}},[B,H]=(0,t.useState)(null),[I,F]=(0,t.useState)([]),[W,U]=(0,t.useState)(!1),[O,q]=(0,t.useState)(""),$=async e=>{if(B===e)return void H(null);H(e),U(!0);try{let{data:r,error:t}=await w.supabase.from("comments").select(`
                    *,
                    profiles:user_id (
                        full_name,
                        avatar_url
                    )
                `).eq("post_id",e).order("created_at",{ascending:!0});if(t)throw t;F(r||[])}catch(e){console.error("Error fetching comments:",e),b.toast.error("Failed to load comments")}finally{U(!1)}},M=async r=>{if(O.trim()&&e)try{let{error:t}=await w.supabase.from("comments").insert({post_id:r,user_id:e.id,content:O});if(t)throw t;q("");let{data:s}=await w.supabase.from("comments").select(`
                    *,
                    profiles:user_id (
                        full_name,
                        avatar_url
                    )
                `).eq("post_id",r).order("created_at",{ascending:!0});F(s||[]),E(e=>e.map(e=>e.id===r?{...e,comments_count:e.comments_count+1}:e)),await w.supabase.from("posts").update({comments_count:S.find(e=>e.id===r).comments_count+1}).eq("id",r)}catch(e){console.error("Error adding comment:",e),b.toast.error("Failed to add comment")}},Y=async e=>{if(confirm("Are you sure you want to delete this post?"))try{let{error:r}=await w.supabase.from("posts").delete().eq("id",e);if(r)throw r;b.toast.success("Post deleted"),E(r=>r.filter(r=>r.id!==e))}catch(e){console.error("Error deleting post:",e),b.toast.error("Failed to delete post")}};return(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("nav",{className:"border-b border-border/40 bg-background/80 backdrop-blur-xl sticky top-0 z-50",children:(0,r.jsx)("div",{className:"container mx-auto px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl gradient-accent flex items-center justify-center",children:(0,r.jsx)(d.Zap,{className:"w-6 h-6 text-primary-foreground"})}),(0,r.jsx)("span",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Sprint IBA"})]}),(0,r.jsx)("div",{className:"hidden md:block flex-1 max-w-md mx-4",children:(0,r.jsx)(ex,{})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(a.Button,{variant:"ghost",onClick:()=>y.push("/dashboard"),children:[(0,r.jsx)(u.Home,{className:"w-4 h-4 mr-2"}),"Dashboard"]}),(0,r.jsxs)(a.Button,{variant:"ghost",onClick:L,children:[(0,r.jsx)(x.LogOut,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]})})}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[(0,r.jsxs)("div",{className:"hidden md:block md:col-span-3 space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)(a.Button,{variant:"secondary",className:"w-full justify-start gap-3 bg-muted/50",children:[(0,r.jsx)(h.MessageCircle,{className:"w-5 h-5"}),"Threads"]}),(0,r.jsxs)(a.Button,{variant:"ghost",className:"w-full justify-start gap-3",onClick:()=>y.push("/messages"),children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(h.MessageCircle,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-primary rounded-full border-2 border-background"})]}),"Messaging",(0,r.jsx)(n.Badge,{variant:"secondary",className:"ml-auto text-xs bg-primary/10 text-primary",children:"1"})]}),(0,r.jsxs)(a.Button,{variant:"ghost",className:"w-full justify-start gap-3",onClick:()=>y.push("/friends"),children:[(0,r.jsx)(p.Users,{className:"w-5 h-5"}),"Friend Requests"]}),(0,r.jsxs)(a.Button,{variant:"ghost",className:"w-full justify-start gap-3",onClick:()=>y.push("/groups"),children:[(0,r.jsx)(p.Users,{className:"w-5 h-5"}),"Groups"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-3 px-2",children:"Recommended groups"}),(0,r.jsx)("div",{className:"space-y-3",children:[{name:"IBA Trans English",members:"2 groups ago",initial:"RT",color:"bg-green-500"},{name:"IBA Exam English",members:"3 groups ago",initial:"IE",color:"bg-red-800"}].map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-3 px-2 py-1 cursor-pointer hover:bg-muted/50 rounded-lg transition-colors",children:[(0,r.jsx)(o.Avatar,{className:"w-8 h-8 rounded-lg",children:(0,r.jsx)(o.AvatarFallback,{className:`${e.color} text-white text-xs`,children:e.initial})}),(0,r.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,r.jsx)("p",{className:"text-sm font-medium truncate",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.members})]})]},t))}),(0,r.jsx)(a.Button,{className:"w-full mt-4",variant:"default",onClick:()=>y.push("/groups"),children:"Create Group"})]})]}),(0,r.jsxs)("div",{className:"md:col-span-6 space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Threads"})}),(0,r.jsx)("div",{className:"md:hidden mb-6",children:(0,r.jsx)(l.Card,{className:"border-border/40",children:(0,r.jsxs)(l.CardContent,{className:"p-4 space-y-4",children:[(0,r.jsx)(i.Textarea,{placeholder:"What's on your mind?",value:C,onChange:e=>_(e.target.value),className:"min-h-[80px] bg-muted/30 border-0 focus-visible:ring-1"}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)(a.Button,{onClick:D,className:"gradient-primary",disabled:T,size:"sm",children:[T&&(0,r.jsx)(f.Loader2,{className:"w-3 h-3 mr-2 animate-spin"}),"Post"]})})]})})}),(0,r.jsx)("div",{className:"space-y-4",children:k?(0,r.jsx)("div",{className:"flex justify-center py-12",children:(0,r.jsx)(f.Loader2,{className:"w-8 h-8 animate-spin text-primary"})}):0===S.length?(0,r.jsx)("div",{className:"text-center py-12 text-muted-foreground bg-card rounded-xl border border-border/40",children:"No posts yet. Be the first to share!"}):S.map((t,s)=>(0,r.jsxs)(l.Card,{className:"border-border/40 hover:border-border/80 transition-all duration-300 animate-fade-in-up",style:{animationDelay:`${.05*s}s`},children:[(0,r.jsx)(l.CardHeader,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(o.Avatar,{className:"w-10 h-10 cursor-pointer",onClick:()=>y.push(`/profile/${t.user_id}`),children:[(0,r.jsx)(o.AvatarImage,{src:t.profiles?.avatar_url}),(0,r.jsx)(o.AvatarFallback,{className:"gradient-accent text-primary-foreground font-bold text-sm",children:t.profiles?.full_name?.charAt(0)||"U"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("p",{className:"font-semibold text-sm cursor-pointer hover:underline",onClick:()=>y.push(`/profile/${t.user_id}`),children:t.profiles?.full_name||"Unknown User"})}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,j.formatDistanceToNow)(new Date(t.created_at),{addSuffix:!0})})]})]}),e?.id===t.user_id&&(0,r.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>Y(t.id),className:"text-muted-foreground hover:text-destructive h-8 w-8",children:(0,r.jsx)(v.Trash2,{className:"w-4 h-4"})})]})}),(0,r.jsxs)(l.CardContent,{className:"space-y-3 pb-3",children:[(0,r.jsxs)("h3",{className:"font-semibold text-lg leading-tight",children:[t.content.split("\n")[0].substring(0,60),t.content.length>60?"...":""]}),(0,r.jsx)("p",{className:"text-muted-foreground text-sm leading-relaxed whitespace-pre-wrap line-clamp-3",children:t.content}),(0,r.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsxs)("div",{className:"flex -space-x-2",children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500 border-2 border-background flex items-center justify-center text-[10px] text-white",children:"A"}),(0,r.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500 border-2 border-background flex items-center justify-center text-[10px] text-white",children:"B"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-muted-foreground",children:[(0,r.jsxs)(a.Button,{variant:"ghost",size:"sm",className:`gap-1.5 h-8 px-2 text-xs ${t.user_has_liked?"text-red-500":""}`,onClick:()=>z(t.id,t.user_has_liked||!1),children:[(0,r.jsx)(m.Heart,{className:`w-4 h-4 ${t.user_has_liked?"fill-current":""}`}),t.likes_count," Likes"]}),(0,r.jsxs)(a.Button,{variant:"ghost",size:"sm",className:"gap-1.5 h-8 px-2 text-xs",onClick:()=>$(t.id),children:[(0,r.jsx)(h.MessageCircle,{className:"w-4 h-4"}),t.comments_count," Comments"]})]})]}),B===t.id&&(0,r.jsxs)("div",{className:"pt-4 space-y-4 animate-fade-in border-t border-border/40 mt-2",children:[(0,r.jsx)("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:W?(0,r.jsx)("div",{className:"text-center text-xs text-muted-foreground",children:"Loading..."}):0===I.length?(0,r.jsx)("div",{className:"text-center text-xs text-muted-foreground",children:"No comments yet."}):I.map(e=>(0,r.jsxs)("div",{className:"flex gap-3 text-sm",children:[(0,r.jsxs)(o.Avatar,{className:"w-6 h-6 cursor-pointer mt-1",onClick:()=>y.push(`/profile/${e.user_id}`),children:[(0,r.jsx)(o.AvatarImage,{src:e.profiles?.avatar_url}),(0,r.jsx)(o.AvatarFallback,{className:"text-[10px]",children:e.profiles?.full_name?.charAt(0)})]}),(0,r.jsxs)("div",{className:"bg-muted/50 p-2 rounded-lg flex-1",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)("span",{className:"font-semibold text-xs cursor-pointer hover:underline",onClick:()=>y.push(`/profile/${e.user_id}`),children:e.profiles?.full_name}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:(0,j.formatDistanceToNow)(new Date(e.created_at),{addSuffix:!0})})]}),(0,r.jsx)("p",{className:"mt-0.5 text-xs",children:e.content})]})]},e.id))}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(c.Input,{placeholder:"Write a comment...",value:O,onChange:e=>q(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),M(t.id))},className:"h-8 text-sm"}),(0,r.jsx)(a.Button,{size:"icon",className:"h-8 w-8",onClick:()=>M(t.id),disabled:!O.trim(),children:(0,r.jsx)(h.MessageCircle,{className:"w-4 h-4"})})]})]})]})]},t.id))}),!k&&S.length>0&&(0,r.jsx)("div",{className:"flex justify-center mt-8",children:(0,r.jsx)(a.Button,{variant:"outline",className:"border-border/40 text-xs h-8",children:"Load More"})})]}),(0,r.jsxs)("div",{className:"hidden md:block md:col-span-3 space-y-6",children:[(0,r.jsxs)(l.Card,{className:"border-border/40 shadow-sm",children:[(0,r.jsxs)(l.CardHeader,{className:"pb-2 pt-4 px-4",children:[(0,r.jsx)(l.CardTitle,{className:"text-base",children:"Share Your Progress"}),(0,r.jsx)(l.CardDescription,{className:"text-xs",children:"Post your achievements, tips, or questions"})]}),(0,r.jsxs)(l.CardContent,{className:"px-4 pb-4 space-y-3",children:[(0,r.jsx)(i.Textarea,{placeholder:"What's on your mind?",value:C,onChange:e=>_(e.target.value),className:"min-h-[100px] bg-muted/30 border-0 focus-visible:ring-1 resize-none text-sm"}),(0,r.jsxs)(a.Button,{onClick:D,className:"w-full gradient-primary",disabled:T,size:"sm",children:[T&&(0,r.jsx)(f.Loader2,{className:"w-3 h-3 mr-2 animate-spin"}),"Post to Community"]})]})]}),(0,r.jsxs)(l.Card,{className:"border-border/40 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex border-b border-border/40",children:[(0,r.jsx)("button",{className:"flex-1 py-3 text-sm font-medium border-b-2 border-primary text-primary",children:"Recent Threads"}),(0,r.jsx)("button",{className:"flex-1 py-3 text-sm font-medium text-muted-foreground hover:text-foreground",children:"Popular"}),(0,r.jsx)("button",{className:"flex-1 py-3 text-sm font-medium text-muted-foreground hover:text-foreground",children:"Following"})]}),(0,r.jsx)(l.CardContent,{className:"p-0",children:(0,r.jsx)("div",{className:"divide-y divide-border/40",children:S.slice(0,3).map(e=>(0,r.jsxs)("div",{className:"p-3 hover:bg-muted/30 cursor-pointer transition-colors",onClick:()=>{},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsxs)(o.Avatar,{className:"w-5 h-5",children:[(0,r.jsx)(o.AvatarImage,{src:e.profiles?.avatar_url}),(0,r.jsx)(o.AvatarFallback,{className:"text-[8px]",children:e.profiles?.full_name?.charAt(0)})]}),(0,r.jsx)("span",{className:"text-xs font-medium truncate max-w-[120px]",children:e.profiles?.full_name}),(0,r.jsxs)("span",{className:"text-[10px] text-muted-foreground ml-auto",children:[(0,j.formatDistanceToNow)(new Date(e.created_at))," ago"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:e.content}),(0,r.jsx)("div",{className:"flex items-center gap-3 mt-2 text-[10px] text-muted-foreground",children:(0,r.jsxs)("span",{children:[e.comments_count," comments"]})})]},`recent-${e.id}`))})})]})]})]})})]})}],39584)}]);